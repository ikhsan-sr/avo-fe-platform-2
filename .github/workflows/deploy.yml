name: Deploy App

on:
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Deploy
        run: |
          echo "Deploying..."
          sleep 3

      - name: Notify Lark - Success
        if: success()
        run: |
          curl -X POST ${{ secrets.LARK_WEBHOOK_URL }} \
          -H "Content-Type: application/json" \
          -d '{ "msg_type": "text", "content": { "text": "✅ Deploy SUCCESS - ${{ github.repository }}" }}'

      - name: Notify Lark - Failed
        if: failure()
        run: |
          curl -X POST ${{ secrets.LARK_WEBHOOK_URL }} \
          -H "Content-Type: application/json" \
          -d '{ "msg_type": "text", "content": { "text": "❌ Deploy FAILED - ${{ github.repository }}" }}'

      - name: Notify Lark - Cancelled
        if: cancelled()
        run: |
          curl -X POST ${{ secrets.LARK_WEBHOOK_URL }} \
          -H "Content-Type: application/json" \
          -d '{ "msg_type": "text", "content": { "text": "⏹ Deploy CANCELLED - ${{ github.repository }}" }}'
